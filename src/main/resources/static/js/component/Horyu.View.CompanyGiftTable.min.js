var Horyu=window.Horyu||{};Horyu.View=window.Horyu.View||{};
Horyu.View.CompanyGiftTable=function(m){var h=$("#company-gift-table"),g=h.find("tbody"),n=h.find("thead"),a=this;a.companyGiftData=[];a.currentEventWinnerData=[];a.nextLotteryGift=null;a.options=$.extend({includeEventWinner:!0},m);a.init=function(){a.updateTableHeaders()};a.updateTableHeaders=function(){var b=n.find("tr");b.append("\x3cth\x3e\ub3c4\uc6c0\uc744 \uc8fc\uc2e0 \ud68c\uc0ac\x3c/th\x3e");b.append("\x3cth\x3e\uc0c1\ud488\x3c/th\x3e");a.options.includeEventWinner?(b.append('\x3cth width\x3d"250px"\x3e\ub2f9\ucca8\uc790 \uc774\uba54\uc77c\x3c/th\x3e'),
b.append('\x3cth width\x3d"250px"\x3e\ub2f9\ucca8\uc790 \uc720\ud29c\ube0c \ub2c9\ub124\uc784\x3c/th\x3e')):b.append('\x3cth width\x3d"100px"\x3e\uc0c1\ud488 \uac1c\uc218\x3c/th\x3e')};a.updateTable=function(){a.nextLotteryGift=null;g.empty();var b=a.companyGiftData.groupBy("companyId");Object.keys(b).forEach(function(c){var d=b[c],d=d.sortBy("prizeId"),f=0;d.forEach(function(b){var d=b.prizeAmount;if(a.options.includeEventWinner)for(var k=0;k<d;k++){var e=$("\x3ctr\x3e\x3c/tr\x3e");0===f&&e.append(a.makeCompanyCell(a.getTotalGiftAmount(c),
b));0===k&&e.append($('\x3ctd class\x3d"gift-cell" rowspan\x3d"'+d+'"\x3e'+b.prizeName+"\x3c/td\x3e"));var l=a.popEventWinner(b.prizeId);null===l?(null===a.nextLotteryGift&&(a.nextLotteryGift=b),e.append($("\x3ctd\x3e").html('\x3ca class\x3d"event-winner-pending-cell"\x3e\ucd94\ucca8\uc744 \uae30\ub2e4\ub9ac\ub294 \uc911...\x3c/a\x3e')),e.append($("\x3ctd\x3e").html('\x3ca class\x3d"event-winner-pending-cell"\x3e\ucd94\ucca8\uc744 \uae30\ub2e4\ub9ac\ub294 \uc911...\x3c/a\x3e'))):(e.append($("\x3ctd\x3e").html('\x3ca class\x3d"event-winner-cell"\x3e'+
l.applicant.applyEmail+"\x3c/a\x3e")),e.append($("\x3ctd\x3e").html('\x3ca class\x3d"event-winner-cell"\x3e'+l.applicant.youtubeNickname+"\x3c/a\x3e")));g.append(e);f++}else e=$("\x3ctr\x3e\x3c/tr\x3e"),0===f&&e.append(a.makeCompanyCell(a.getTotalGiftSize(c),b)),e.append($("\x3ctd\x3e").text(b.prizeName)),e.append($("\x3ctd\x3e").text(d+"\uac1c")),g.append(e),f++})})};a.makeCompanyCell=function(a,c){var d=$('\x3ctd class\x3d"company-cell"\x3e').attr("rowspan",a),f=$('\x3cimg class\x3d"company-logo" src\x3d"/companyLogo?companyId\x3d'+
c.companyId+'"/\x3e'),g=$('\x3ca style\x3d"font-size: 16pt;font-weight: bold;"\x3e'+c.companyName+"\x3c/a\x3e"),h=$('\x3ca style\x3d"color: gray"\x3e'+c.companyDetail+"\x3c/a\x3e");null!==c.companyLogoImageFileName?d.append(f):d.append(g);d.append("\x3cbr/\x3e");d.append(h);return d};a.popEventWinner=function(b){var c=a.currentEventWinnerData.filter(function(a){return a.prizeId===b}),c=c.sortBy(function(a){return moment(a.winTime).unix()});if(0===c.length)return null;var d=c[0];a.currentEventWinnerData.remove(function(a){return a.applicant.applyEmail===
d.applicant.applyEmail});return d};a.getTotalGiftSize=function(b){var c=0;a.companyGiftData.filter(function(a){return a.companyId===Number(b)}).forEach(function(a){c++});return c};a.getTotalGiftAmount=function(b){var c=0;a.companyGiftData.filter(function(a){return a.companyId===Number(b)}).forEach(function(a){c+=a.prizeAmount});return c};a.deepCopy=function(a){return JSON.parse(JSON.stringify(a))};return{init:a.init,updateTable:function(b,c){a.companyGiftData=a.deepCopy(b);a.currentEventWinnerData=
a.deepCopy(c);a.updateTable()},getNextLotteryGift:function(){return a.nextLotteryGift}}};
//# sourceMappingURL=Horyu.View.CompanyGiftTable.min.js.map