var Horyu=window.Horyu||{};Horyu.View=window.Horyu.View||{};
Horyu.View.Apply=function(h){var a=this;a.options=$.extend({applyCount:0,eventStatus:"CLOSE",eventStartTime:0,eventEndTime:0,prizeList:[]},h);a.init=function(){a.initFingerprint2();a.initParsley();a.updateAlertBanner();a.updateTable()};a.initFingerprint2=function(){(new Fingerprint2({excludeWebGL:!0})).get(function(a){$("#fingerprint2").val(a)})};a.initParsley=function(){$("#applyForm").parsley({successClass:"is-valid",errorClass:"is-invalid",classHandler:function(a){return a.$element.closest("input")}})};
a.updateAlertBanner=function(){var c=$(".alert-banner");if("START_SOON"===a.options.eventStatus)c.html('\x3ca style\x3d"font-weight: bold; font-size: 20pt;"\x3e\ub2e4\uc74c \uc2dc\uac04 \uc774\ud6c4\uc5d0 \uc751\ubaa8\uac00 \uac00\ub2a5\ud569\ub2c8\ub2e4.\x3c/a\x3e\x3cbr/\x3e\x3ca id\x3d"time-countdown" style\x3d"font-weight: bold; font-size: 32pt;"\x3e\x3c/a\x3e'),$("#time-countdown").countdown(moment.unix(a.options.eventStartTime).toDate()).on("update.countdown",function(a){$(this).html(a.strftime("%D\uc77c %H\uc2dc\uac04 %M\ubd84 %S\ucd08"))}).on("finish.countdown",
function(a){$(".alert-banner").html('\x3ca style\x3d"font-weight: bold; font-size: 20pt;"\x3e\ud398\uc774\uc9c0\uac00 \uc790\ub3d9 \uc0c8\ub85c\uace0\uce68\ub429\ub2c8\ub2e4.\x3cbr/\x3e\uc0c8\ub85c\uace0\uce68\uc774 \uc548\ub420 \uacbd\uc6b0, \uc9c1\uc811 \uc0c8\ub85c\uace0\uce68 \ubc84\ud2bc\uc744 \ub20c\ub7ec\uc8fc\uc138\uc694.\x3c/a\x3e');window.location.reload()});else if("ALREADY_END"===a.options.eventStatus){var b={useEasing:!0,useGrouping:!0,separator:",",decimal:".",suffix:"\uba85"},b=new CountUp("applyCount",
0,a.options.applyCount,0,5,b);b.error?console.error(b.error):b.start();c.html('\x3ca style\x3d"font-weight: bold; font-size: 20pt;"\x3e\ub2e4\uc74c \uc2dc\uac04 \uc804\uc5d0 \uc774\ubbf8 \uc751\ubaa8 \uc2e0\uccad\uc774 \ub9c8\uac10\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\x3c/a\x3e\x3cbr/\x3e\x3ca id\x3d"time-countdown" style\x3d"font-weight: bold; font-size: 32pt;"\x3e\x3c/a\x3e');c=moment.unix(a.options.eventEndTime).subtract(new Date);$("#time-countdown").countdown(c.toDate(),{elapse:!0}).on("update.countdown",
function(a){$(this).html(a.strftime("%D\uc77c %H\uc2dc\uac04 %M\ubd84 %S\ucd08"))})}else"OPEN"===a.options.eventStatus?(c.html('\x3ca style\x3d"font-size: 12pt;"\x3e\x3ca id\x3d"time-countdown" style\x3d"font-weight: bold;"\x3e\x3c/a\x3e \uc774\ud6c4 \uc751\ubaa8 \uc2e0\uccad\uc774 \ub9c8\uac10\ub429\ub2c8\ub2e4.\x3c/a\x3e'),b={useEasing:!0,useGrouping:!0,separator:",",decimal:".",suffix:"\uba85"},b=new CountUp("applyCount",0,a.options.applyCount,0,3,b),b.error?console.error(b.error):b.start(),$("#time-countdown").countdown(moment.unix(a.options.eventEndTime).toDate()).on("update.countdown",
function(a){$(this).html(a.strftime("%D\uc77c %H\uc2dc\uac04 %M\ubd84 %S\ucd08"))}).on("finish.countdown",function(a){$(".alert-banner").html('\x3ca style\x3d"font-weight: bold; font-size: 20pt;"\x3e\uc751\ubaa8 \uc2e0\uccad\uc774 \ub9c8\uac10\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\x3c/a\x3e');window.location.reload()})):"CLOSE"===a.options.eventStatus?c.text("\ud604\uc7ac \uc751\ubaa8 \uc2e0\uccad\uc744 \ubc1b\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."):"LOTTERY"===a.options.eventStatus&&(c.html("\uc544\ub798\uc5d0\uc11c \ud604\uc7ac \uc774\ubca4\ud2b8 \ub2f9\ucca8\uc790 \ubaa9\ub85d\uc744 \ud655\uc778\ud558\uc2e4 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),
c.removeClass("alert-warning"),c.addClass("alert-success"),a.updateEventWinnerTable())};a.updateTable=function(){var c=$("#prize-table tbody");c.empty();var b=a.options.prizeList.groupBy("companyId");Object.forEach(b,function(a){var b=0;Object.forEach(a,function(d){var e=$("\x3ctr\x3e");if(0===b){var f=$('\x3ctd class\x3d"company-cell" rowspan\x3d"'+a.length+'"\x3e\x3ca style\x3d"font-size: 16pt;font-weight: bold;"\x3e'+d.companyName+'\x3c/a\x3e\x3cbr/\x3e\x3ca style\x3d"color: gray"\x3e'+d.companyDetail+
"\x3c/a\x3e\x3c/td\x3e");e.append(f)}e.append($("\x3ctd\x3e").text(d.prizeName));e.append($("\x3ctd\x3e").text(d.prizeAmount));c.append(e);b++})})};a.updateEventWinnerTable=function(){a.nextLotteryPrize=null;var c=$("#event-winner-table tbody");c.empty();var b=a.options.prizeList.groupBy("companyId");Object.forEach(b,function(b){b=b.sortBy("prizeId");var g=0;Object.forEach(b,function(d){var e=$("\x3ctr\x3e");if(0===g){var f=$('\x3ctd class\x3d"company-cell" rowspan\x3d"'+b.length+'"\x3e\x3ca style\x3d"font-size: 16pt;font-weight: bold;"\x3e'+
d.companyName+'\x3c/a\x3e\x3cbr/\x3e\x3ca style\x3d"color: gray"\x3e'+d.companyDetail+"\x3c/a\x3e\x3c/td\x3e");e.append(f)}e.append($("\x3ctd\x3e").text(d.prizeName));null===d.applicant?(e.append($("\x3ctd\x3e").html('\x3ca style\x3d"color:gray"\x3e\ucd94\ucca8 \ub300\uae30 \uc911\x3c/a\x3e')),e.append($("\x3ctd\x3e").html('\x3ca style\x3d"color:gray"\x3e\ucd94\ucca8 \ub300\uae30 \uc911\x3c/a\x3e')),null===a.nextLotteryPrize&&(a.nextLotteryPrize=d)):(e.append($("\x3ctd\x3e").html('\x3ca style\x3d"color:blue;font-weight: bold"\x3e'+
d.applicant.applyEmail+"\x3c/a\x3e")),e.append($("\x3ctd\x3e").html('\x3ca style\x3d"color:blue;font-weight: bold"\x3e'+d.applicant.youtubeNickname+"\x3c/a\x3e")));c.append(e);g++})})};return{init:function(){a.init()}}};