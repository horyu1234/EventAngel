var Horyu=window.Horyu||{};Horyu.View=window.Horyu.View||{};
Horyu.View.PrizeSetting=function(c){var a=this;a.deletingPrizeId=0;a.options=$.extend({prizeList:[]},c);a.init=function(){a.updateTable();a.bindEvents()};a.bindEvents=function(){$(".prizeEditBtn").click(function(b){a.startPrizeEdit($(b.target))});$(".prizeDeleteBtn").click(function(b){a.startDelete($(b.target))});$("#cancelEditBtn").click(function(){a.abortPrizeEdit()});$("#deleteAbortBtn").click(function(){a.abortDelete()});$("#deleteBtn").click(function(){a.deleteConfirm()})};a.startPrizeEdit=function(a){a=
a.closest("tr");$("#prizeId").val(a.find(".prize-name").attr("data-prize-id"));$("#companyId").val(a.find(".prize-name").attr("data-company-id"));$("#prizeName").val(a.find(".prize-name").text());$("#prizeAmount").val(a.find(".prize-amount").text());$(".card-header").text("\uc0c1\ud488 \uc218\uc815");$("#submitBtn").text("\uc0c1\ud488 \uc218\uc815");$("#cancelEditBtn").css("visibility","visible");$("html, body").animate({scrollTop:0},"fast")};a.abortPrizeEdit=function(){$("#prizeId").val("0");$("#prizeName").val("");
$("#prizeAmount").val("");$(".card-header").text("\uc0c1\ud488 \ucd94\uac00");$("#submitBtn").text("\uc0c1\ud488 \ucd94\uac00");$("#cancelEditBtn").css("visibility","hidden")};a.startDelete=function(b){b=b.closest("tr");a.deletingPrizeId=Number(b.find(".prize-name").attr("data-prize-id"));$("#delete-modal").modal({backdrop:"static",keyboard:!1})};a.abortDelete=function(){a.deletingPrizeId=0};a.deleteConfirm=function(){$("#deleteBtn").html("\ucc98\ub9ac \uc911\uc785\ub2c8\ub2e4.");$("#deleteBtn").attr("disabled",
"");$("#deleteAbortBtn").css("visibility","hidden");$.ajax({type:"POST",url:"./deletePrize",data:{prizeId:a.deletingPrizeId},timeout:5E3}).done(function(){$("#deleteBtn").html("\uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.");setTimeout(function(){location.reload()},500)}).fail(function(a){$("#deleteBtn").html("\ud1b5\uc2e0\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");setTimeout(function(){location.reload()},3E3)})};a.updateTable=
function(){var b=$("#prize-table tbody");b.empty();var c=a.options.prizeList.groupBy("companyId");Object.forEach(c,function(a){a=a.sortBy("prizeId");var c=0;Object.forEach(a,function(d){var e=$("\x3ctr\x3e");if(0===c){var f=$('\x3ctd class\x3d"company-cell" rowspan\x3d"'+a.length+'"\x3e\x3ca style\x3d"font-size: 16pt;font-weight: bold;"\x3e'+d.companyName+'\x3c/a\x3e\x3cbr/\x3e\x3ca style\x3d"color: gray"\x3e'+d.companyDetail+"\x3c/a\x3e\x3c/td\x3e");e.append(f)}e.append($('\x3ctd class\x3d"prize-name"\x3e').attr("data-prize-id",
d.prizeId).attr("data-company-id",d.companyId).text(d.prizeName));e.append($('\x3ctd class\x3d"prize-amount"\x3e').text(d.prizeAmount));e.append($('\x3ctd\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-info btn-sm prizeEditBtn"\x3e\uc218\uc815\x3c/button\x3e\x3c/td\x3e'));e.append($('\x3ctd\x3e\x3cbutton type\x3d"button" class\x3d"btn btn-danger btn-sm prizeDeleteBtn"\x3e\uc0ad\uc81c\x3c/button\x3e\x3c/td\x3e'));b.append(e);c++})})};return{init:function(){a.init()}}};