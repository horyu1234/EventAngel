var Horyu=window.Horyu||{};Horyu.View=window.Horyu.View||{};
Horyu.View.EventSetting=function(c){var a=this;a.options=$.extend({eventStartTime:0,eventEndTime:0},c);a.init=function(){a.initDateRangePicker();a.bindEvents();a.updateVisibleStatus("OPEN"===a.getOpenEventBtnId())};a.initDateRangePicker=function(){$("#eventTerm").daterangepicker({timePicker:!0,timePickerIncrement:1,timePickerSeconds:!0,showDropdowns:!0,todayHighlight:!0,startDate:moment.unix(a.options.eventStartTime),endDate:moment.unix(a.options.eventEndTime),dateLimit:{year:1},locale:{format:"YYYY\ub144 MM\uc6d4 DD\uc77c A h\uc2dc mm\ubd84 ss\ucd08",
applyLabel:"\uc801\uc6a9",cancelLabel:"\ucde8\uc18c",daysOfWeek:"\uc77c\uc6d4\ud654\uc218\ubaa9\uae08\ud1a0".split(""),monthNames:"1\uc6d4 2\uc6d4 3\uc6d4 4\uc6d4 5\uc6d4 6\uc6d4 7\uc6d4 8\uc6d4 9\uc6d4 10\uc6d4 11\uc6d4 12\uc6d4".split(" ")}})};a.bindEvents=function(){$(".eventStatusButton").change(function(){a.updateVisibleStatus("OPEN"===$(this).attr("id"))});$(".submitBtn").click(function(){var b=$("#eventTerm").data("daterangepicker");$("#eventStatus").val(a.getOpenEventBtnId());$("#eventStartTime").val(b.startDate.unix());
$("#eventEndTime").val(b.endDate.unix());$("#eventSettingForm").submit()});$(".endEventBtn").click(function(){$("#end-event-modal").modal({backdrop:"static",keyboard:!1})});$("#endEventConfirmBtn").click(function(){$("#endEventConfirmBtn").html("\ucc98\ub9ac \uc911\uc785\ub2c8\ub2e4.");$("#endEventConfirmBtn").attr("disabled","");$(".abortBtn").css("visibility","hidden");$.ajax({type:"GET",url:"./endEvent",timeout:5E3}).done(function(){$("#endEventConfirmBtn").html("\uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.");
setTimeout(function(){location.reload()},500)}).fail(function(a){$("#endEventConfirmBtn").html("\ud1b5\uc2e0\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");setTimeout(function(){location.reload()},3E3)})});$(".resetEventWinner").click(function(){$("#reset-event-winner-modal").modal({backdrop:"static",keyboard:!1})});$("#resetEventWinnerConfirmBtn").click(function(){$("#resetEventWinnerConfirmBtn").html("\ucc98\ub9ac \uc911\uc785\ub2c8\ub2e4.");
$("#resetEventWinnerConfirmBtn").attr("disabled","");$(".abortBtn").css("visibility","hidden");$.ajax({type:"GET",url:"./resetEventWinner",timeout:5E3}).done(function(){$("#resetEventWinnerConfirmBtn").html("\uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.");setTimeout(function(){location.reload()},500)}).fail(function(a){$("#resetEventWinnerConfirmBtn").html("\ud1b5\uc2e0\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.");setTimeout(function(){location.reload()},
3E3)})})};a.getOpenEventBtnId=function(){return $(".eventStatusBtnGroup .active input").attr("id")};a.updateVisibleStatus=function(a){a?$(".eventOpenSettingGroup").show(500):$(".eventOpenSettingGroup").hide(500)};return{init:function(){a.init()}}};